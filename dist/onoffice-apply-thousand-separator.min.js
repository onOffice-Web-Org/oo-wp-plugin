onoffice_setting=onoffice_setting||[];jQuery(document).ready((function($){let thousandSeparatorFormat=onoffice_setting.thousand_separator_format||"";function getSeparators(separatorFormat){return{thousandSeparator:separatorFormat==="comma-separator"?",":".",decimalSeparator:separatorFormat==="comma-separator"?".":","}}function cleanInputValue(value,separatorFormat){return separatorFormat==="comma-separator"?value.replace(/[^0-9.]/g,""):value.replace(/[^0-9,]/g,"")}function formatForThousandSeparator(fieldKey,fieldValue,separatorFormat){const{thousandSeparator:thousandSeparator,decimalSeparator:decimalSeparator}=getSeparators(separatorFormat);let value=processSeparator(fieldValue,thousandSeparator,decimalSeparator);$('input[name="'+fieldKey+'"]').val(value)}function processSeparator(value,thousandSeparator,decimalSeparator){let parts=value.split(/[,.]/);if(parts.length>2){let integerPart=parts.shift();let decimalPart=parts.join("");value=integerPart+"."+decimalPart}let match=value.match(/^(\d+)[,.](\d+)$/);if(match){return match[1].replace(/\B(?=(\d{3})+(?!\d))/g,thousandSeparator)+decimalSeparator+match[2]}else{return value.replace(/\B(?=(\d{3})+(?!\d))/g,thousandSeparator)}}function applyThousandSeparatorFormat(element){let inputName=$(element).attr("name");let inputValue=$(element).val();inputValue=cleanInputValue(inputValue,thousandSeparatorFormat);formatForThousandSeparator(inputName,inputValue,thousandSeparatorFormat)}$(".apply-thousand-separator-format").on("input",(function(){applyThousandSeparatorFormat(this)})).each((function(){applyThousandSeparatorFormat(this)}))}));